{"data":{"site":{"siteMetadata":{"title":"William's Blog","author":"William"}},"markdownRemark":{"id":"a3329cc0-17cd-5c4b-98dd-8f2352b052ea","excerpt":"前言 　　MVC、MVP和MVVM是开发GUI（图形用户界面）应用程序时常用的软件架构模式。它们的目的是通过一些手段将GUI应用程序的用户界面（View）和数据（Model）进行分离，提高代码的可复用性和可维护性。本文对三种架构模式的思想进行了深入研究并对比分析了它们的优缺点。 MVC 　　MVC模式将GUI…","html":"<h2>前言</h2>\n<p>　　MVC、MVP和MVVM是开发GUI（图形用户界面）应用程序时常用的软件架构模式。它们的目的是通过一些手段将GUI应用程序的用户界面（View）和数据（Model）进行分离，提高代码的可复用性和可维护性。本文对三种架构模式的思想进行了深入研究并对比分析了它们的优缺点。</p>\n<h2>MVC</h2>\n<p>　　MVC模式将GUI应用程序分成三个模块：<strong>Model</strong>、<strong>View</strong>和<strong>Controller</strong>。这三个模块相互之间的交互如图1所示。</p>\n<div style=\"text-align: center;\">\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f03b3d6ce1bcbe2d105f5fbf2c673a1c/438a5/MVC.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 460px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 51.95652173913044%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABcSAAAXEgFnn9JSAAACUklEQVQoz3VSbUhTYRR+7t2HbrXAooTc0sY0xUGQ6cqM9TNCV35Mg9kcfaqkleWPyqAPRIjAJg7qZ/VjIO7eq+a0q9NNzY0+KHFF/aqQ8E8Q/TMiTu9du1KRLxze933OOc97zvMeTANQTFmLAJc+4l2MOAiN4+b4aTq7GKDzyftknj9FEHxPrTIZ1LhlZqYIIcT2GQWI/UO2BGQ1elo3IULbILg7DcN1yQL5TKJwoiXOzm8guru4EbIag/F1BGQoOZ/SHFPqKy/SZM8By6RG67P658tApMUay3YnpsMrKhjLNLqfAXYFS6jd5fUd0LBk7oEFhggP7+7rQSe761PO6Sj3uaoC1P6Qo8th7vu5BuBx+HfiN8rI7Y86ZB3fEs5EjgLtuVqm+evlwn7KZWRpDZY5+k91KSzxcVVrV2eyiGG61QBOqi1FyFmOgUsNELuO6kL7HRhqMql+pnF+FHAyK58FNqq4NnzciGCpA9KFagx3uPBoZwUGD5UAoutH1piHSqbbafOo5yee1BAnXfFpBikb8lebo2tgV2VL776DbYG91rtzxRj9YssUKQehm03myAmyTzTTjslmcsxcpPUjDSuAXEuGKQ8de9tLBXNthNk64qUbHZAomxc+FCFKVrykPCRoO8IrNohLhdoh2grx2knTnJeqF3qo9f09qlzoJo1cz7qXjnSzKvsZu18j1fghHg5wkidfbU3W6osjPO9j1jiuN1j+kMoCoarPOFzftyXs9euH6gIQKm+tNRmw9xiRHgc9G9gNTD/TayD1i0W310zDL3iT3um6cDwiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"MVC交互示意图\"\n        title=\"\"\n        src=\"/static/f03b3d6ce1bcbe2d105f5fbf2c673a1c/438a5/MVC.png\"\n        srcset=\"/static/f03b3d6ce1bcbe2d105f5fbf2c673a1c/d6ca3/MVC.png 148w,\n/static/f03b3d6ce1bcbe2d105f5fbf2c673a1c/8ec60/MVC.png 295w,\n/static/f03b3d6ce1bcbe2d105f5fbf2c673a1c/438a5/MVC.png 460w\"\n        sizes=\"(max-width: 460px) 100vw, 460px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n</div>\n<div style=\"text-align: center;\">图 1 MVC软件架构模式模块之间交互示意图</div>\n<p>　　对上述三个模块相互之间的交互描述如下: Model可以直接访问数据，其与View和Controller是独立的。Model自身并不关心其是如何被View显示和被Controller操作的，但是Model中数据发生变化后会以一种机制通知View，让View进行更新。为了实现这种机制，可以让相关View在Model上进行注册（或者订阅），当Model数据发生变动时，Model调用View提供的接口可以让对应的View知晓数据的变动。Controller的作用是组织Model和View，控制应用程序的流程。Controller接受来自View反馈的用户行为，然后根据用户行为操作Model引起数据的改变，进而触发View的更新。Controller也可以根据用户行为直接更新View。<br>\n　　以使用MVC模式开发一个传统的Web页面应用为例，Model、View和Controller的定义如下：<br>\n　　Model: 用于封装与Web页面应用的业务逻辑相关的数据以及对数据的处理方法。<br>\n　　View: 浏览器展示给用户的Web页面。<br>\n　　Controller: 转发请求或者对请求进行处理。<br>\n　　以JavaScript语言为例，使用MVC模式开发一个加减计数器实例如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * 使用MVC架构模式实现一个加减计数器\n * Model实现了对计数器count的封装\n * View将count值展示到页面\n * Controller处理用户动作\n */</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Model</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscribers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">// 每次加1</span>\n    <span class=\"token function\">addCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">// 每次减1</span>\n    <span class=\"token function\">subCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">// 读取count值</span>\n    <span class=\"token function\">getCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">// 设置count值</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">// 订阅数据变更</span>\n    <span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>view<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscribers<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>view<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">// 发布通知</span>\n    <span class=\"token function\">publish</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscribers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>v <span class=\"token operator\">=></span> v<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>controller<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elText <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#elText'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elAdd <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#elAdd'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elSub <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#elSub'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>controller <span class=\"token operator\">=</span> controller<span class=\"token punctuation\">;</span>\n        \n        <span class=\"token comment\">// 绑定事件</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elAdd<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>controller<span class=\"token punctuation\">.</span>handleAdd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elSub<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>controller<span class=\"token punctuation\">.</span>handleSub<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elText<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span><span class=\"token function\">getCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Controller</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>view <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">View</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Model</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token comment\">// 订阅model数据变更</span>\n       <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token function\">handleAdd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">addCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 发布变更通知</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">publish</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token function\">handleSub</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">subCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 发布变更通知</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">publish</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 启动应用</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">Controller</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>　　MVC架构的应用使得复杂的GUI应用程序变得模块化，提高了应用程序的可复用性和可扩展性。MVC架构的应用也使得GUI应用的开发人员变得分工明确，开发人员可以根据自己的专长来从事Model、View或者Controller层面的开发，各个开发人员之间协商好接口之后便可以开始并行开发，从而提高了程序开发效率。虽然MVC架构模式具有上述优点，但是由于其View层和Controller层关联过于紧密，View和Controller一般一一对应，通常将两者打包成一个组件，并且在MVC模式中View层直接可以访问Model，这样可能会造成数据安全性问题。为了让Controller单独可复用以及View和Model进一步隔离，人们对MVC架构模式进行了改进，设计出了MVP这一软件架构模式。</p>\n<h2>MVP</h2>\n<p>　　MVP模式使用<strong>Presenter</strong>替换了MVC模式中的Controller，MVP架构模式中各个模块的交互如图2所示。</p>\n<div style=\"text-align: center;\">\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/73e4c607f95fc7996f85c2027fc39942/ad191/MVP.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 16.382978723404253%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABcSAAAXEgFnn9JSAAAA/klEQVQI1wHzAAz/AACwUHwLs1eDDLNYhQCzUXhEcEgXuAcPPLUKETRKXU8VC7dccQ6zWYYQtFqECLdadz9qPxu6BQxJugQLRTJ/XBgAslJ5D7RZhQy0WIIAr0+BAADGVv842YH/OdyD/wDBVv8CsK5TALP/LQC1/y8ArMFHD79i/0bgjP9T45T/Echo/wCspVoAtv8sB63/LwCsqlMIxl//Xeab/1Xilf8AyFr/AACuTZEPtFqYErVcmQCwTo0zhl0ZvQIIRbgGC0JsWUMUAK9Kgxm3YJsfuWSZALBNjDx9Ux+9AQdMvQILPimEShYBslKNJbppmSS7aJcAr0+WhTNjd2h/7C4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"MVP架构模式模块之间交互示意图\"\n        title=\"\"\n        src=\"/static/73e4c607f95fc7996f85c2027fc39942/40fad/MVP.png\"\n        srcset=\"/static/73e4c607f95fc7996f85c2027fc39942/707e9/MVP.png 148w,\n/static/73e4c607f95fc7996f85c2027fc39942/649e0/MVP.png 295w,\n/static/73e4c607f95fc7996f85c2027fc39942/40fad/MVP.png 590w,\n/static/73e4c607f95fc7996f85c2027fc39942/b3fef/MVP.png 885w,\n/static/73e4c607f95fc7996f85c2027fc39942/301c0/MVP.png 1180w,\n/static/73e4c607f95fc7996f85c2027fc39942/ad191/MVP.png 1410w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n</div>\n<div style=\"text-align: center;\">图 2 MVP软件架构模式模块之间交互示意图</div>\n<p>　　在MVP架构模式中Model和View之间完全独立，Presenter作为中间协调器将两者联系起来。在MVP模式中，Model不知晓View的存在，View也不知晓Model的存在，数据的更新以及页面的刷新全部由Presenter来控制。<br>\n　　使用MVP架构模式对上述采用MVC架构的加减计数器代码进行重构，重构后的代码如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * 使用MVP架构模式重构加减计数器\n * Model实现了对计数器count的封装\n * View将count值展示到页面\n * Presenter负责数据的更新与View的刷新\n */</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Model</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">// 每次加1</span>\n    <span class=\"token function\">addCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">// 每次减1</span>\n    <span class=\"token function\">subCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">// 读取count值</span>\n    <span class=\"token function\">getCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">// 设置count值</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elText <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#elText'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elAdd <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#elAdd'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elSub <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#elSub'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>presenter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Presenter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 绑定事件</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elAdd<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>presenter<span class=\"token punctuation\">.</span>handleAdd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elSub<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>presenter<span class=\"token punctuation\">.</span>handleSub<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>elText<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Presenter</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>view<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>view <span class=\"token operator\">=</span> view<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Model</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n   \n    <span class=\"token function\">handleAdd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 更新数据</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">addCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 更新页面</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            value<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">getCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token function\">handleSub</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 更新数据</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">subCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 更新页面</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            value<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span><span class=\"token function\">getCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 启动应用</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">View</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>　　MVP模式与MVC模式相比，其优点在于Model层和View层完全独立，Presenter作为中间层保持View和Model之间的同步。在MVC和MVP模式中均存在一个问题: Controller和Presenter都需要直接或者间接地调用View提供的接口来对页面进行刷新。对于开发者来说，直接调用View接口来更新页面不仅增加了代码量，而且在某些场景下会频繁地操作DOM。如何解决这些问题？在MVP架构模式的基础上，人们引入数据绑定的概念，设计出了目前流行的MVVM软件架构模式。</p>\n<h2>MVVM</h2>\n<p>　　MVVM模式使用<strong>ViewModel</strong>替换了MVP模式中的Presenter，该模式下模块之间的交互如图3所示。</p>\n<div style=\"text-align: center;\">\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/584efeed021db45dbba1c4480fa8e132/ad191/MVVM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 16.382978723404253%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABcSAAAXEgFnn9JSAAAA+0lEQVQI12NgWOtVw7EptBmIWxk2+FU6VUjy3mBg0L3GwKDRbsvAwbApsJBhnW8bwzq/FobNgeVeuW7SO1l5PHexcLsa1cdIMGwKquTfEtnKsyWiiWG9fyOD0Ln0/053Ov57POz9z3I49j/r0k7HJqt420rnVBuWmdNNpA9m/je4Vfvf4EbNf6WzJf8Z1q2MYtj6X4d97X99hjWrgjmOxf+PfTb7f+ijqf8ZTkT9ZxDZFjdRdmfKDMVdaTM5N4X1MWysFWGAge0LeNk3hrbxbomcxbs5Yib71sges2o/+X2M7D57mbjtNFu8xBg3BfWq7sqcqbI7YzrQhdMAwHRfxrvnJFgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"MVVM交互示意图\"\n        title=\"\"\n        src=\"/static/584efeed021db45dbba1c4480fa8e132/40fad/MVVM.png\"\n        srcset=\"/static/584efeed021db45dbba1c4480fa8e132/707e9/MVVM.png 148w,\n/static/584efeed021db45dbba1c4480fa8e132/649e0/MVVM.png 295w,\n/static/584efeed021db45dbba1c4480fa8e132/40fad/MVVM.png 590w,\n/static/584efeed021db45dbba1c4480fa8e132/b3fef/MVVM.png 885w,\n/static/584efeed021db45dbba1c4480fa8e132/301c0/MVVM.png 1180w,\n/static/584efeed021db45dbba1c4480fa8e132/ad191/MVVM.png 1410w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n</div>\n<div style=\"text-align: center;\">图 3 MVVM软件架构模式模块之间交互示意图</div>\n<p>　　与Presenter调用View提供的接口进行页面刷新不同，ViewModel通过数据绑定的方式将View和ViewModel进行绑定，当用户操作页面时，ViewModel自动获取到页面的变动，并自动更新Model；当Model数据发生变动时，ViewModel获取到数据变动后自动更新View。数据绑定功能实现了View和Model的自动同步，开发人员尤其是前端工程师在开发GUI应用程序时不用再关心页面如何渲染以及页面渲染是否高效的问题，开发人员重点关注如何处理前端业务逻辑。<br>\n　　使用JavaScript语言的MVVM框架Vue.js对上述加减计数器进行重构，重构后的代码如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * 使用Vue.js重构加减计数器\n * Model是一个对象，保存了业务数据，在本例中就是count值\n * View可以看做是Vue模板，通过Vue提供的相应的模板语法和ViewModel进行数据和事件的绑定\n * ViewModel是一个Vue对象，数据绑定功能由Vue框架内部实现，开发者无需关心，只需关心业务逻辑即可\n */</span>\n\n<span class=\"token keyword\">const</span> model <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    count<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">// View\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>app<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>{{count}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">@click</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>handleAdd<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>+<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">@click</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>handleSub<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>-<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ViewModel</span>\n<span class=\"token keyword\">const</span> viewModel <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    el<span class=\"token punctuation\">:</span> <span class=\"token string\">'#app'</span><span class=\"token punctuation\">,</span>\n    data<span class=\"token punctuation\">:</span> model<span class=\"token punctuation\">,</span>\n    methods<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">handleAdd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token function\">handleSub</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>　　MVVM架构模式进一步提高了GUI应用程序的研发效率。为了实现数据绑定，部分MVVM框架可能会创建出很多观察器来对数据进行观察，对于数据结构复杂的GUI应用而言，数据绑定可能会占用大量的内存空间。</p>\n<h2>总结</h2>\n<p>　　MVC、MVP以及MVVM等MV*架构模式都是为了分离GUI应用程序的Model（数据）和View（界面）以提高研发效率和增强GUI应用程序可维护性而提出来的软件架构模式。它们之间的差异在于各个模块之间的耦合程度以及程序研发的关注点。了解不同架构模式的优缺点可以帮助我们在应对不同的业务需求时选择合适的软件架构模式，依靠某一种架构模式应对所有的业务场景是不合适的。</p>\n<h2>参考文献</h2>\n<ol>\n<li><a href=\"https://martinfowler.com/eaaDev/uiArchs.html\">GUI Architectures</a></li>\n<li><a href=\"https://zh.wikipedia.org/wiki/MVC\">Wikipedia: MVC</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter\">Wikipedia: Model–view–presenter</a></li>\n<li><a href=\"https://zh.wikipedia.org/wiki/MVVM\">Wikipedia: MVVM</a></li>\n<li><a href=\"https://blogs.msdn.microsoft.com/johngossman/2006/03/04/advantages-and-disadvantages-of-m-v-vm/\">MSDN: Advantages and disadvantages of M-V-VM</a></li>\n<li><a href=\"https://addyosmani.com/blog/understanding-mvvm-a-guide-for-javascript-developers/\">Understanding MVVM - A Guide For JavaScript Developers</a></li>\n<li><a href=\"https://juejin.im/post/593021272f301e0058273468\">掘金: 浅析前端开发中的 MVC/MVP/MVVM 模式</a></li>\n</ol>","frontmatter":{"title":"MVC、MVP、MVVM软件架构学习笔记","date":"August 24, 2018","description":"MVC、MVP和MVVM是开发GUI（图形用户界面）应用程序时常用的软件架构模式。它们的目的是通过一些手段将GUI应用程序的用户界面（View）和数据（Model）进行分离，提高代码的可复用性和可维护性。本文对三种架构模式的思想进行了深入研究并对比分析了它们的优缺点。"}}},"pageContext":{"slug":"/notes/20180824143040/","previous":{"fields":{"slug":"/notes/20180718144710/"},"frontmatter":{"title":"sourcemap学习笔记"}},"next":{"fields":{"slug":"/notes/20180920212719/"},"frontmatter":{"title":"ECMAScript 5的严格模式"}}}}